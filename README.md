# Portfolio Analyzer

ãƒˆãƒ¬ãƒ¼ãƒ‡ã‚£ãƒ³ã‚°ãƒ“ãƒ¥ãƒ¼ï¼ˆTradingViewï¼‰ã®ãƒãƒƒã‚¯ãƒ†ã‚¹ãƒˆ Excel ãƒ•ã‚¡ã‚¤ãƒ«ï¼ˆ`.xlsx`ï¼‰ã‚’èª­ã¿è¾¼ã¿ã€  
**è¤‡æ•°éŠ˜æŸ„ï¼ˆæˆ¦ç•¥ï¼‰ã®ãƒ‘ãƒ•ã‚©ãƒ¼ãƒãƒ³ã‚¹ã‚’ä¸€æ‹¬è©•ä¾¡ã§ãã‚‹ PyQt6 ãƒ‡ã‚¹ã‚¯ãƒˆãƒƒãƒ—ã‚¢ãƒ—ãƒª** ã§ã™ã€‚

- ãƒ€ãƒ¼ã‚¯ãƒ†ãƒ¼ãƒ & é»’èƒŒæ™¯ï¼‹èµ¤ãƒ©ã‚¤ãƒ³ã® *Equity Curve*
- è¤‡æ•°ãƒ•ã‚¡ã‚¤ãƒ«ã‚’ãƒ‰ãƒ©ãƒƒã‚°ï¼†ãƒ‰ãƒ­ãƒƒãƒ—ã§è¿½åŠ 
- ãƒ•ã‚¡ã‚¤ãƒ«ã”ã¨ã« ON/OFFãƒ»å‰Šé™¤ï¼ˆã‚´ãƒŸç®±ï¼‰ãƒ»All ON / All OFFãƒ»ä¸€æ‹¬ãƒªã‚»ãƒƒãƒˆ
- è¨±å®¹æœ€å¤§ãƒ‰ãƒ­ãƒ¼ãƒ€ã‚¦ãƒ³ & Monte Carlo è©¦è¡Œå›æ•°ã‚’ã‚¹ãƒ©ã‚¤ãƒ€ãƒ¼ï¼‹æ•°å€¤å…¥åŠ›ã§å³æ™‚èª¿æ•´
- æ—¥æœ¬èª / è‹±èª UI ãƒ¯ãƒ³ã‚¯ãƒªãƒƒã‚¯åˆ‡æ›¿ï¼ˆã‚¿ã‚¤ãƒˆãƒ« *Equity Curve* ã¯è‹±èªå›ºå®šï¼‰

---

## ğŸš€ ä¸»ãªç‰¹å¾´ (Overview)

| åŒºåˆ† | å†…å®¹ |
|------|------|
| å…¥åŠ› | è¤‡æ•° `.xlsx` è¿½åŠ  / åŒæ™‚èª­è¾¼ / ãƒ‰ãƒ©ãƒƒã‚°ï¼†ãƒ‰ãƒ­ãƒƒãƒ— |
| ãƒ•ã‚¡ã‚¤ãƒ«ç®¡ç† | ãƒã‚§ãƒƒã‚¯ ON/OFF / å€‹åˆ¥å‰Šé™¤ / All ON / All OFF / å…¨ãƒªã‚»ãƒƒãƒˆ / å†è¨ˆç®—ï¼ˆé¸æŠã®ã¿ï¼‰ |
| å¯è¦–åŒ– | ãƒ€ãƒ¼ã‚¯ãƒ†ãƒ¼ãƒï¼‹èµ¤ãƒ©ã‚¤ãƒ³ã®ã‚¨ã‚¯ã‚¤ãƒ†ã‚£ã‚«ãƒ¼ãƒ–ï¼ˆé«˜ã‚³ãƒ³ãƒˆãƒ©ã‚¹ãƒˆï¼‰ |
| æŒ‡æ¨™ | CAGR / Max DD / Sharpe / Sortino / Profit Factor / Expectancy / Payoff / Win Rate / Avg Win / Avg Loss / Streaks / Trade Count / Risk of Ruin / RoR Step |
| Monte Carlo | è¨±å®¹æœ€å¤§ DD (%) ã¨è©¦è¡Œå›æ•°ï¼ˆ1kã€œ100kï¼‹ä»»æ„ 100ã€œ500kï¼‰å¯å¤‰ |
| å¤šè¨€èª | æ—¥æœ¬èª / è‹±èª å³æ™‚åˆ‡æ›¿ |
| UX | ã‚¹ãƒ©ã‚¤ãƒ€ãƒ¼ï¼‹SpinBox åŒæœŸã€ãƒ‰ãƒ©ãƒƒã‚°ï¼†ãƒ‰ãƒ­ãƒƒãƒ—ã€ã‚´ãƒŸç®±å‰Šé™¤ã€3ãƒ–ãƒ­ãƒƒã‚¯æŒ‡æ¨™ãƒ¬ã‚¤ã‚¢ã‚¦ãƒˆ |
| å®Ÿè¡Œ | `python -m pyqt_portfolio_analyzer` ã¾ãŸã¯ `start_app.bat` |

---

## ğŸ§ª Risk of Ruin (Monte Carlo) ã®æ¦‚è¦

- ãƒˆãƒ¬ãƒ¼ãƒ‰æç›Šç³»åˆ—ã‚’ **å¾©å…ƒæŠ½å‡º (bootstrap)** ã§ãƒ©ãƒ³ãƒ€ãƒ ä¸¦ã³ç”Ÿæˆ  
- é€”ä¸­ã®æœ€å¤§ãƒ”ãƒ¼ã‚¯ã‹ã‚‰ã®ãƒ‰ãƒ­ãƒ¼ãƒ€ã‚¦ãƒ³ç‡ãŒ **è¨±å®¹æœ€å¤§DD (ï¼…)** ã‚’è¶…ãˆãŸæ™‚ç‚¹ã§ â€œç ´ç”£â€ åˆ¤å®š  
- ç ´ç”£ç‡ = ç ´ç”£ãŒç™ºç”Ÿã—ãŸè©¦è¡Œæ•° / ç·è©¦è¡Œæ•° Ã— 100  
- åˆ†è§£èƒ½ (RoR Step) = 100 / è©¦è¡Œæ•°  
- è©¦è¡Œå›æ•°ã‚’å¢—ã‚„ã™ã¨å®‰å®šã™ã‚‹ãŒè¨ˆç®—ã‚³ã‚¹ãƒˆ â†‘  
- ï¼ˆå°†æ¥ï¼‰ä¹±æ•°ã‚·ãƒ¼ãƒ‰å›ºå®šã‚ªãƒ—ã‚·ãƒ§ãƒ³äºˆå®š  

---

## ğŸ“Š å®Ÿè£…æ¸ˆã¿æŒ‡æ¨™

| æŒ‡æ¨™ | èª¬æ˜ |
|------|------|
| CAGR (%) | å¹´ç‡è¤‡åˆ©ãƒªã‚¿ãƒ¼ãƒ³ |
| Max Drawdown (%) | æœ€å¤§ãƒ‰ãƒ­ãƒ¼ãƒ€ã‚¦ãƒ³ï¼ˆãƒ”ãƒ¼ã‚¯æ¯”ï¼‰ |
| Sharpe Ratio | å¹´ç‡åŒ–å¹³å‡ / å¹´ç‡åŒ–æ¨™æº–åå·®ï¼ˆRf=0ï¼‰ |
| Sortino Ratio | ä¸‹æ–¹åå·®ã‚’ç”¨ã„ãŸ Sharpe å¤‰ç¨® |
| Profit Factor | ç·åˆ©ç›Š Ã· |ç·æå¤±| |
| Expectancy | 1ãƒˆãƒ¬ãƒ¼ãƒ‰æœŸå¾…å€¤ (AvgWin * WinRate âˆ’ |AvgLoss| * (1âˆ’WinRate)) |
| Payoff Ratio | å¹³å‡åˆ©ç›Š Ã· |å¹³å‡æå¤±| |
| Win Rate (%) | å‹ç‡ |
| Avg Win / Avg Loss | å‹ã¡/è² ã‘å¹³å‡æç›Š |
| Max Win Streak / Max Lose Streak | æœ€å¤§é€£å‹ / æœ€å¤§é€£æ•— |
| Trade Count | ç·ãƒˆãƒ¬ãƒ¼ãƒ‰æ•° |
| Risk of Ruin (%) | Monte Carlo ç ´ç”£ç¢ºç‡ |
| RoR Step (%) | è¡¨ç¤ºåˆ†è§£èƒ½ï¼ˆ=100/è©¦è¡Œæ•°ï¼‰ |

---

## ğŸ–¼ ã‚¹ã‚¯ãƒªãƒ¼ãƒ³ã‚·ãƒ§ãƒƒãƒˆ

![screenshot](docs/screenshot.png)

---

## ğŸ“ ä½¿ã„æ–¹ (Quick Start)

1. ã€Œ**Excelãƒ•ã‚¡ã‚¤ãƒ«ã‚’é–‹ã**ã€ãƒœã‚¿ãƒ³ã‹ã€ç©ºã®ãƒ•ã‚¡ã‚¤ãƒ«ãƒªã‚¹ãƒˆé ˜åŸŸã« `.xlsx` ã‚’ **ãƒ‰ãƒ©ãƒƒã‚°ï¼†ãƒ‰ãƒ­ãƒƒãƒ—**  
2. è‡ªå‹•ã§ã‚¨ã‚¯ã‚¤ãƒ†ã‚£ã‚«ãƒ¼ãƒ– & æŒ‡æ¨™ã‚’è¨ˆç®—è¡¨ç¤º  
3. è¨±å®¹æœ€å¤§DD (%) ã‚’ã‚¹ãƒ©ã‚¤ãƒ€ãƒ¼ / æ•°å€¤å…¥åŠ›ã§å¤‰æ›´ â†’ Risk of Ruin è‡ªå‹•å†è¨ˆç®—  
4. Monte Carlo è©¦è¡Œå›æ•°ã‚’èª¿æ•´ï¼ˆã‚¹ãƒ©ã‚¤ãƒ€ãƒ¼ or æ•°å€¤å…¥åŠ›ï¼‰  
5. ãƒ•ã‚¡ã‚¤ãƒ«ä¸€è¦§ã§ ON/OFFã€ã‚´ãƒŸç®±å‰Šé™¤ / All ON / All OFF / å…¨ãƒªã‚»ãƒƒãƒˆ  
6. ã€Œå†è¨ˆç®—ï¼ˆãƒã‚§ãƒƒã‚¯ã®ã¿ï¼‰ã€ã§æœ‰åŠ¹ãƒ•ã‚¡ã‚¤ãƒ«ã®ã¿å†é›†è¨ˆï¼ˆé«˜é€ŸåŒ–ç”¨ï¼‰  
7. ğŸŒ ãƒœã‚¿ãƒ³ã§ JP / EN åˆ‡æ›¿  

---

## ğŸ“¦ å¯¾å¿œ Excel å½¢å¼

| é …ç›® | å†…å®¹ |
|------|------|
| å¿…é ˆã‚·ãƒ¼ãƒˆ | `ãƒˆãƒ¬ãƒ¼ãƒ‰ä¸€è¦§` |
| å¿…é ˆåˆ—ä¾‹ | `æ—¥æ™‚`ï¼ˆç´„å®šã¾ãŸã¯ç¢ºå®šæ™‚åˆ»ï¼‰ã€æç›Šåˆ—ï¼ˆ`æç›Š` / `Profit` ç­‰ï¼‰ |
| æ—¥æ¬¡é›†è¨ˆ | `æ—¥æ™‚` ã‚’æ—¥ä»˜åŒ– â†’ æ—¥æ¬¡æç›Šåˆè¨ˆ â†’ ç´¯ç©å’Œã§ Equity |
| åˆæœŸè³‡é‡‘ | `metrics.py` å†…ã§å®šç¾©ï¼ˆä¾‹: 100,000ï¼‰å¤‰æ›´å¯ |

> åˆ—åãŒç•°ãªã‚‹å ´åˆã¯ `data_loader.py` ã®ãƒãƒƒãƒ”ãƒ³ã‚°ã‚’èª¿æ•´ã€‚

---

## âš™ ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ« / å®Ÿè¡Œ

```bash
# 1. å–å¾—
git clone https://github.com/your-account/portfolio_analyzer.git
cd portfolio_analyzer

# 2. ç’°å¢ƒä½œæˆ
conda create -n pa-env python=3.12 -y
conda activate pa-env

# 3. ä¾å­˜
pip install -r requirements.txt
# ï¼ˆç„¡ã„å ´åˆï¼‰
pip install pyqt6 pandas numpy matplotlib openpyxl

# 4. èµ·å‹•
python -m pyqt_portfolio_analyzer
# ã¾ãŸã¯
start_app.bat
